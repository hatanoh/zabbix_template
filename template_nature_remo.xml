<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.4</version>
    <template_groups>
        <template_group>
            <uuid>665e3e4e629a4ffcab9b053cab873217</uuid>
            <name>Templates/IoT devices</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>bb3287a4de1442968234edbdcbd542e8</uuid>
            <template>Nature Remo</template>
            <name>Nature Remo</name>
            <groups>
                <group>
                    <name>Templates/IoT devices</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>1550c57a880043e0b4db98c49252880d</uuid>
                    <name>nr.device</name>
                    <type>HTTP_AGENT</type>
                    <key>nr.device</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>https://api.nature.global/1/devices</url>
                    <follow_redirects>NO</follow_redirects>
                    <headers>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>8e600cf2366045a8a3c5cb8b331f68a3</uuid>
                    <name>dicovery_remo</name>
                    <type>HTTP_AGENT</type>
                    <key>dicovery_remo</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#FIRMWARE}</macro>
                                <value>^Remo/[0-9\.].+$</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$DEVICENAME.MATCHES}</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$DEVICENAME.NOMATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>0ae3411b9fd04c5998821a496af7e711</uuid>
                            <name>nr.device[{#NAME}]</name>
                            <type>HTTP_AGENT</type>
                            <key>nr.device[{#NAME}]</key>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <discover>NO_DISCOVER</discover>
                            <value_type>TEXT</value_type>
                            <timeout>10s</timeout>
                            <url>https://api.nature.global/1/devices/{#DEVICE_ID}/appliances</url>
                            <follow_redirects>NO</follow_redirects>
                            <headers>
                                <header>
                                    <name>Authorization</name>
                                    <value>Bearer {$ACCESS_TOKEN}</value>
                                </header>
                                <header>
                                    <name>Content-Type</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b69461f2afe84bc7a61fe266cef10c42</uuid>
                            <name>Humidity[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.humidity[{#NAME}]</key>
                            <delay>0</delay>
                            <units>%</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#DEVICE_ID}&quot;)].newest_events.hu.val.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.device</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ba054786ec2c411b87441b40aafadac2</uuid>
                            <name>Illumination[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.Illumination[{#NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#DEVICE_ID}&quot;)].newest_events.il.val.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.device</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a4ac09cab09840998d04f0ad3a6bf813</uuid>
                            <name>Movement[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.movement[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#DEVICE_ID}&quot;)].newest_events.mo.val.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.device</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>dacea4989d844e67be8258a1fa0a0bd6</uuid>
                            <name>Online[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.online[{#NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#DEVICE_ID}&quot;)].online.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.device</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>48af86d5d883489390b614fdf1a80d1a</uuid>
                            <name>Temperature[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.temperature[{#NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>℃</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$[?(@.id == &quot;{#DEVICE_ID}&quot;)].newest_events.te.val.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.device</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>4d4debfa9c4043c3a352d79a8c63eda6</uuid>
                            <name>Temperature &amp; Humidity[{#NAME}]</name>
                            <graph_items>
                                <graph_item>
                                    <color>F63100</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Nature Remo</host>
                                        <key>nr.environment.humidity[{#NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Nature Remo</host>
                                        <key>nr.environment.temperature[{#NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <timeout>10s</timeout>
                    <url>https://api.nature.global/1/devices</url>
                    <headers>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#DEVICE_ID}</lld_macro>
                            <path>$.id</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#FIRMWARE}</lld_macro>
                            <path>$.firmware_version</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>ebb7cee9254549fea0619fd3b09a6ce4</uuid>
                    <name>dicovery_remo_E</name>
                    <type>HTTP_AGENT</type>
                    <key>dicovery_remo_E</key>
                    <delay>1h</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#FIRMWARE}</macro>
                                <value>^Remo-E-lite/[0-9\.].+$</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$DEVICENAME.MATCHES}</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#NAME}</macro>
                                <value>{$DEVICENAME.NOMATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>226cb1b0648a4c14bfbc3081ad01ceeb</uuid>
                            <name>nr.appliance[{#NAME}]</name>
                            <type>HTTP_AGENT</type>
                            <key>nr.appliance[{#NAME}]</key>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://api.nature.global/1/devices/{#APPLIANCE_ID}/appliances</url>
                            <follow_redirects>NO</follow_redirects>
                            <headers>
                                <header>
                                    <name>Authorization</name>
                                    <value>Bearer {$ACCESS_TOKEN}</value>
                                </header>
                                <header>
                                    <name>Content-Type</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d6707ef471d449c6ad9af03f3093913c</uuid>
                            <name>nr.appliance_1d[{#NAME}]</name>
                            <type>HTTP_AGENT</type>
                            <key>nr.appliance_1d[{#NAME}]</key>
                            <delay>0;h0</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://api.nature.global/1/devices/{#APPLIANCE_ID}/appliances</url>
                            <follow_redirects>NO</follow_redirects>
                            <headers>
                                <header>
                                    <name>Authorization</name>
                                    <value>Bearer {$ACCESS_TOKEN}</value>
                                </header>
                                <header>
                                    <name>Content-Type</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                        </item_prototype>
                        <item_prototype>
                            <uuid>73243da82541417eb44d72d025e6c15c</uuid>
                            <name>nr.appliance_30m[{#NAME}]</name>
                            <type>HTTP_AGENT</type>
                            <key>nr.appliance_30m[{#NAME}]</key>
                            <delay>0;m/30</delay>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <timeout>10s</timeout>
                            <url>https://api.nature.global/1/devices/{#APPLIANCE_ID}/appliances</url>
                            <follow_redirects>NO</follow_redirects>
                            <headers>
                                <header>
                                    <name>Authorization</name>
                                    <value>Bearer {$ACCESS_TOKEN}</value>
                                </header>
                                <header>
                                    <name>Content-Type</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <output_format>JSON</output_format>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3087c99d8fc144be9c675e40007b9820</uuid>
                            <name>Power[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.measured_instantaneous[{#NAME}]</key>
                            <delay>0</delay>
                            <units>W</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.smart_meter.echonetlite_properties.[?(@.epc == 231)].val.first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.appliance[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9ae93bbc5e594251b52195810cef72c8</uuid>
                            <name>Cumulative_Power_30ｍ[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.normal_direction_cumulative_electric_energy[{#NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>kWh</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.smart_meter.echonetlite_properties.[?(@.epc == 224)].val.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>0.1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.appliance_30m[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>766cc6a246c94677986368fca4af5c4a</uuid>
                            <name>Cumulative_Power_1d[{#NAME}]</name>
                            <type>DEPENDENT</type>
                            <key>nr.environment.normal_direction_cumulative_electric_energy_1d[{#NAME}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>kWh</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.smart_meter.echonetlite_properties.[?(@.epc == 224)].val.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>0.1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>SIMPLE_CHANGE</type>
                                    <parameters>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>nr.appliance_1d[{#NAME}]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>component</tag>
                                    <value>environment</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>8f937339c9d64ed2bddeb54da038d354</uuid>
                            <name>Power[{#NAME}]</name>
                            <graph_items>
                                <graph_item>
                                    <color>F63100</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Nature Remo</host>
                                        <key>nr.environment.measured_instantaneous[{#NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Nature Remo</host>
                                        <key>nr.environment.normal_direction_cumulative_electric_energy[{#NAME}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>274482</color>
                                    <yaxisside>RIGHT</yaxisside>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>Nature Remo</host>
                                        <key>nr.environment.normal_direction_cumulative_electric_energy_1d[{#NAME}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <timeout>10s</timeout>
                    <url>https://api.nature.global/1/devices</url>
                    <headers>
                        <header>
                            <name>Authorization</name>
                            <value>Bearer {$ACCESS_TOKEN}</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#APPLIANCE_ID}</lld_macro>
                            <path>$.id</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#FIRMWARE}</lld_macro>
                            <path>$.firmware_version</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>hardware</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>nature remo</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$ACCESS_TOKEN}</macro>
                    <description>Token</description>
                </macro>
                <macro>
                    <macro>{$DEVICENAME.MATCHES}</macro>
                    <value>.+</value>
                </macro>
                <macro>
                    <macro>{$DEVICENAME.NOMATCHES}</macro>
                    <value>0^</value>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>2d175af7e4c14d42aa6d6369b886c097</uuid>
                    <name>Natureremo</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>graphprototype</type>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>Nature Remo</host>
                                                <name>Power[{#NAME}]</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graphprototype</type>
                                    <x>12</x>
                                    <width>12</width>
                                    <height>5</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH_PROTOTYPE</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>Nature Remo</host>
                                                <name>Temperature &amp; Humidity[{#NAME}]</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
        </template>
    </templates>
</zabbix_export>
